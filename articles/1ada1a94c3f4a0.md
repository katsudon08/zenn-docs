---
title: "【React基礎】どのようなシーンで適切？条件付きレンダリングの基本"
emoji: "❓"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["React", "初心者", "フロントエンド"]
published: true
---
# 1.はじめに
Reactでは、コンポーネントの表示・非表示を条件に応じて切り替える「条件付きレンダリング」を行うことがよくあります。

状況としては、「**データがある時だけ表示する**」「**エラー時だけメッセージを出す**」といった場面が多いです。

Reactでは、特別な構文はなく、純粋なJavaScriptの構文を使います。

今回はそんな条件付きレンダリングの基本的な方法について解説します！

# 2.if文による条件分岐
まず、基本的なJavaScriptの条件分岐である`if`文を用いた方法です。

方法としては単純で、コンポーネントの中で`if`文を使い、条件に応じて異なるJSXを返す形となります。

例えば、「パッキングリスト」のアイテムを表示するコンポーネントを考えてみましょう。
準備が完了しているかどうかで、表示する内容を完全に分けたい場合に`if`文が有効です。

```ts
interface Props = {
    name: string;
    isPacked: boolean;
}

function Item({ name, isPacked }: Props) {
    // 早期リターンをするのが、理想です！
    if (isPacked) {
        return <li className="item">{name} ✅</li>;
    }

    return <li className="item">{name}</li>;
}

export default function PackagingList() {
    return (
        <section>
            <h1>パッキングリスト</h1>
            <ul>
                <Item name="宇宙服" isPacked={true} />
                <Item name="おにぎり" isPacked={false} />
            </ul>
        </section>
    );
}
```

上記のように`else`を使わずに、早期リターンで書くと、コードのネストが深くならず、可読性が向上します。

また、何も表示したくないときは`null`を返すことで対応できます。

```ts
if (isPacked) {
    return null;
}

return <li className="item">{name}</li>;
```

:::message
注意点として、JSXの中では、`if文`を直接使用することができません。

そのため、`if`文は必ず`return`の外側で記述するようにしてください！
:::

# 3.参考演算子による条件分岐
次に、JavaScriptの三項演算子を用いた条件付きレンダリングの方法です。

JSXのタグの中で、一部分だけをサクッと書き換えたいという場面で最も活躍する方法です。

`if`文を用いて書くと`DRY原則`に反してしまう場合などに有効で、可読性を保つことができます。

基本的な書き方はJavaScriptの`条件 ? 真の場合 : 偽の場合`という構文を、波括弧`{}`の中で用います。

```ts
interface Props = {
    name: string;
    isPacked: boolean;
}

function Item({ name, isPacked }: Props) {
    return (
        <li className="item">
            {/* isPackedがtrueなら✅、falseなら何も出さない */}
            {name} {isPacked ? '✅' : ''}
        </li>
    );
}
```

この書き方により、`<li>`タグを一回書くだけで済むので`DRY原則`に反しません。

また、テキストのみならず、class名やコンポーネント自体を切り替えることも可能です。

```ts:class名の切り替え
<li className={isPacked ? 'grey-text' : 'normal-text'}>
    {name}
</li>
```

```ts:コンポーネントの切り替え
<li className="item">
    {isPacked ? <PackedItem name={name} /> : <UnpackedItem name={name} />}
</li>
```

なかなかに便利なので、何度も使いたくなりますが、**参考演算子のネストは可読性を著しく下げるため、避けましょう**。

# 4.論理演算子による条件分岐
条件が一致したときだけ表示し、そうでないときは何も出したくないという場面に、`参考演算子`よりも簡潔に書けるのが`&&`（**論理演算子**）です。

JavaScriptの左辺がtrueなら右辺を評価する性質を利用します。

```ts
interface Props = {
    name: string;
    isPacked: boolean;
}

function Item({ name, isPacked }: Props) {
    return (
        <li className="item">
            {name} {isPacked && '✅'}
        </li>
    );
}
```

このコードは、`isPacked`が`true`のときだけ`'✅'`が表示され、`false`のときは何も表示されません。
三項演算子で末尾に`: ''`と書くよりも簡潔に書けるため、表示・非表示の切り替えについてはこちらを使うのがおすすめです。

:::message
`&&`を使う際に、最もハマりやすいポイントとして、**左辺が数値の`0`の場合、右辺が評価されず、画面に`0`と表示されてしまう**ことです。

例えば、以下のコードでは`count`が`0`のときに`0`と表示されてしまいます。

```ts:NG例
return (
    <div>
        {count && <p>未読メッセージ：{count}件</p>}
    </div>
);
```

これは、JavaScriptにおいて`0`は`false`と同様の判定をされますが、**Reactは数値の`0`を「画面に表示すべき有効な値」として扱ってしまう**ためにおこる現象です。

解決策としては、必ず真偽値になるようにしましょう！

```ts:OK例
// ⭕️ 解決策1：比較演算子を使う（おすすめ）
{count > 0 && <p>未読メッセージ：{count}件</p>}

// ⭕️ 解決策2：Boolean関数や !! で変換する
{!!count && <p>未読メッセージ：{count}件</p>}
```
:::

# 6.変数にJSXを代入する
「もし、Aならこれ、Bならこれ、それ以外ならこれ...」と条件がいくつも重なった時、非常に読みにくくバグの温床にもなります。

このようなときは、**JSXを変数に入れてしまう**ことで、`return`文の中身を驚くほどクリーンに保つことができます。

例えば、パッキングリストで「完了」「未完了」「重要度」によって表示を変えたい場合を考えてみましょう。

```ts
interface Props = {
    name: string;
    isPacked: boolean;
    importance: number;
}

function Item({ name, isPacked, importance }: Props) {
    let itemContent = name;

    if (isPacked) {
        itemContent = name + '✅';
    }

    if (importance > 0) {
        itemContent = itemContent = (
            <span>
                {itemContent} ⚡{importance}
            </span>
        );
    }

    // return文は常にシンプルに！
    return (
        <li className="item">
            {itemContent}
        </li>
    )
}
```

このようにJSXを変数に入れることで、条件分岐が複雑になっても、`return`文の中身をシンプルに保つことができます。

また、**「何を表示するのか」のロジックと「どこに配置するのか」の構造が分離できる**ため、コードの意図が伝えやすくなります。

# 7.まとめ
Reactにおける条件付きレンダリングにはいくつかの手法がありますが、大切なのは「**その場の状況に合わせて最も可読性の高いものを選ぶこと**」です。

最後に、今回紹介した4つの手法について振り返ってみましょう！

- **if文**

適したシーンはコンポーネント全体を切り替えたいときです。

コツとしては`else`を使わず、`早期リターン`をすることです。

- **参考演算子**

適したシーンはJSXの一部分を切り替えたいときです。

ネストしないように注意が必要です！

- `&&`演算子

適したシーンは表示・非表示の切り替えたいときです。

最も短く書けますが、左辺の値によってはバグを生むので注意が必要です！

- 変数への代入

適したシーンは条件が複雑になってロジックが長い時です。

JSXをクリーンに保てるため、`let`を使って柔軟に中身を変えましょう。

# 8.参考
- [条件付きレンダー](https://ja.react.dev/learn/conditional-rendering)